# 柱状图

## 1、 代码实现

```html
<!doctype html>
<html lang="en">
<head>
	<meta charset="UTF-8" />
	<title>柱状图</title>
	<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
	<link rel="stylesheet" type="text/css" href="css/mui.css"/>
	<script src="js/jquery.min.js" type="text/javascript" charset="utf-8"></script>
</head>
<body>
	
	<script src="js/mui.js" type="text/javascript" charset="utf-8"></script>
	<script type="text/javascript">
	mui.init()
	</script>
	<header class="mui-bar mui-bar-nav">
		<h1 class="mui-title">柱状图</h1>
	</header>
	<div class="mui-content">
		<canvas id="canvas" width="400" height="250"></canvas>
		<script type="text/javascript">
			let canvas = document.getElementById('canvas')
			let ctx = canvas.getContext('2d')
			mui.ajax('http://127.0.0.1:10001/api/carInfo', {
				type: 'GET',
				success: function(e){
					console.log(e)
					let data = e.data
					let total = data.reduce((a, b)=>{
						if(a[b.carNumberType]){
							a[b.carNumberType]+=1
						}else{
							a[b.carNumberType]=1
						}
						return a
					}, {})
					console.log(total)
					let x_value=[]
					let y_value=[]
					for(let [x, y] of Object.entries(total)){
						x_value.push(x)
						y_value.push(y)
					}
					
					let y_max = Math.max(...y_value)
					if(y_max%10!=0){
						y_max = y_max + (10-y_max%10)
					}
					cvsWidth = canvas.width
					cvsHeight = canvas.height
					let padding = 50
					ctx.beginPath()
					ctx.moveTo(padding, padding)
					ctx.lineTo(padding, cvsHeight-padding)
					ctx.lineTo(cvsWidth-padding, cvsHeight-padding)
					ctx.strokeStyle = '#000'
					ctx.stroke()
					
					y_step = y_max/4
					ctx.textAlign = 'center'
					ctx.font = '14px Arial'
					for (var i = 0; i < y_value.length+2; i++) {
						ctx.beginPath()
						ctx.fillText(y_step*i, padding/2, padding+(cvsHeight-padding*2)-(cvsHeight-padding*2)/4*i)
					}
					
					x_step = (cvsWidth-padding*2)/3
					for (var i = 0; i < x_value.length; i++) {
						ctx.beginPath()
						ctx.fillText(x_value[i], padding+x_step*(i+1), cvsHeight-padding/2)
					}
					
					for (var i = 0; i < x_value.length; i++) {
						ctx.beginPath()
						console.log(y_value)
						ctx.moveTo(padding+x_step*(i+1), cvsHeight-padding)
						ctx.lineTo(padding+x_step*(i+1), padding+(cvsHeight-padding*2)-y_value[i]/y_max*(cvsHeight-padding*2))
						ctx.lineWidth = 20
						ctx.strokeStyle = '#1678ff'
						ctx.stroke()
					}
				}
			})
		</script>
	</div>
</body>
</html>
```

