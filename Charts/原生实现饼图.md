# 原生实现饼图

## 一、代码实现

```html
<!doctype html>
<html>

	<head>
		<meta charset="utf-8">
		<title></title>
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<link href="css/mui.css" rel="stylesheet" />
	</head>

	<body>
		<script src="js/mui.js"></script>
		<script type="text/javascript">
			mui.init()
		</script>
		<header class="mui-bar mui-bar-nav">
			<h1 class="mui-title">饼图</h1>
		</header>
		<div class="mui-content">
			<canvas id="canvas" width="400" height="400"></canvas>
			<script type="text/javascript">
			var data = [10,30,25,15]  // 设置数据
			var colors = ['#1678ff', '#13d7ff', '#aaaaaa', '#198a2f']  // 设置每个数据对应的填充颜色
			var texts = ['A', 'B', 'C', 'D']  // 设置每个数据的标签文字
			var startAngle = 0  // 设置起始角度为0
			var total = data.reduce((a,b)=>{  // 对data中的数据进行求和
				return a+b
			},0)
            	// 获取canvas画布
				var canvas = document.getElementById('canvas')  
                //获取二维渲染对象
				var ctx = canvas.getContext("2d")  
                
				// 对数据进行遍历，分别绘制每一块区域
				data.forEach(function(item, index){  
                    // 设置终止角度
					var endAngle = startAngle+(item/total)*2*Math.PI  
                    
					ctx.beginPath()
                    // 移动到圆心
					ctx.moveTo(200,200)  
                    // 绘制圆，圆心坐标(200,200)，半径为150，起始角度为startAngle，终止角度为endAngle
					ctx.arc(200,200,150,startAngle, endAngle)  
					ctx.closePath()
					ctx.fillStyle = colors[index]  // 设置填充的颜色
					ctx.fill()  // 进行填充
					
					// 为每块区域绘制文字
					var midAngle = (startAngle + endAngle)/2  // 获取这块区域的角度的中间值
					var _x = 200 + 75*Math.cos(midAngle)  // 获取文字所在的 x 轴坐标，其中200为圆心所在 x 轴坐标
					var _y = 200 + 75*Math.sin(midAngle)  // 获取文字所在的 y 轴坐标，其中200为圆心所在 y 轴坐标
					
					ctx.font = '16px Arial'  // 设置文字大小与字体样式
					ctx.textAlign = 'center'  // 设置文字对齐方式
					ctx.textBaseline = 'middle'
                    
                    // 如果填充色接近白色，则字体为黑色，。填充色接近黑色，字体为白色
					if(parseInt(colors[index].replace('#',''),16)>16777215/2){  
						ctx.fillStyle = 'black'
					}else{
						ctx.fillStyle = 'white'
					}
					ctx.fillText(texts[index], _x, _y)  // 绘制文字
					console.log(parseInt('FFFFFF', 16))
					
					startAngle = endAngle  // 将下一个区域的起始角度设置为当前区域的终止角度
				})
			</script>
		</div>
	</body>

</html>

```

